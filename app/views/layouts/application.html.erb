<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for?(:title) ? yield(:title) : "Timeline" %></title>
    <%= stylesheet_link_tag "application" %>
    <% if Rails.env.production? then %>
      <%= javascript_include_tag 'jquery/jquery.min' %>
      <%= javascript_include_tag 'jquery/jquery-ui.min' %>
      <%# simile timeline from MIT servers: <script src="http://static.simile.mit.edu/timeline/api-2.3.0/timeline-api.js" type="text/javascript"></script> %>
      <script src="/javascripts/timeline/timeline_ajax/simile-ajax-api.js?bundle=true" type="text/javascript"></script>
      <script src="/javascripts/timeline/timeline_js/timeline-api.js?bundle=true" type="text/javascript"></script>
    <% else %>
      <%= javascript_include_tag 'jquery/jquery' %>
      <%= javascript_include_tag 'jquery/jquery-ui' %>
      <script src="/javascripts/timeline/src/ajax/api//simile-ajax-api.js?bundle=false" type="text/javascript"></script>
      <script src="/javascripts/timeline/src/webapp/api/timeline-api.js?bundle=false" type="text/javascript"></script>
    <% end %>
    <%# Freebase suggest %> 
    <link type="text/css" rel="stylesheet" href="http://freebaselibs.com/static/suggest/1.2.1/suggest.min.css" />
    <link type="text/css" rel="stylesheet" href="/javascripts/jquery.css" />
    <script type="text/javascript" src="http://freebaselibs.com/static/suggest/1.2.1/suggest.min.js"></script>
    <%= javascript_include_tag 'rails' %>
    <%= javascript_include_tag 'application' %>
    <%= csrf_meta_tag %>
    <%= yield(:head) %>
  </head>
  <body>
 
    <div id="container">
      <div id="user_nav">
          <% if current_user %>
            <%= button_to 'Log out', current_user, :method=>:delete %>
          <% else %>
            <%= (RPXNow.popup_code("#{submit_tag 'Sign in'}",'timeline', users_url)).html_safe %>
          <% end %>
      </div>
      <div id="ajax_flash_error" class="flash_error" style="display:none"></div>
      <div id="ajax_flash_notice" class="flash_notice" style="display:none"></div>
      <div id= "timeline_chart_errors" style="display:none"></div>
      <div id= "event_errors" style="display:none"></div>
      <% flash.each do |name, msg| %>
        <%= content_tag :div, msg, :id => "flash_#{name}", :class => "flash_#{name}" %>
      <% end %>
      <%= content_tag :h1, yield(:title) if show_title? %> 
      <%= yield %>
    </div>
  </body>
</html>
